~~~
proc tonosDeVozElevados(in r: reunion, 
    in freq: Z, 
    in prof : Z, 
    out hablantes: seq<hablante>) {
    Pre { esReuniónVálida(r, prof, freq) }
    Post {
        siPertenecenAHablantesElPromedioDeAmplitudEsMasGrandeOIgualQueElResto(r, hablantes) ∧L
            losHablantesPertenecenALaReunión(r, hablantes) ∧L
            losHablantesNoSeRepiten(hablantes)
    }
}

pred siPertenecenAHablantesElPromedioDeAmplitudEsMasGrandeOIgualQueElResto(r: reunion, hs: seq<hablante>) {
    (∀i : Z) (
        (0 ≤ i < |r|) →L (
            ((snd(r[i]) ∈ hs) ∧ elPromedioDeAmplitudEsMasGrandeOIgualQueElResto(r, fst r[i]))
            ∨
            ((snd(r[i]) !∈ hs) ∧ ¬elPromedioDeAmplitudEsMasGrandeOIgualQueElResto(r, fst r[i]))
        )
    ) 
}

pred losHablantesNoSeRepiten(r: reunion, hs: seq<hablante>) {
    (∀i : Z) (
        (0 ≤ i < |hs|) →L (
            #apariciones(hs, hs[i]) = 1
        )
    )
}

pred losHablantesPertenecenALaReunión(r: reunion, hs: seq<hablantes>) {
    (∀i : Z) (
        (0 ≤ i < |hs|) →L (
            (∃j : Z) (
                (0 ≤ j < |r|) ∧L (
                    hs[i] = (snd r[j]))
                )
            ) 
        )
    )
}

pred elPromedioDeAmplitudEsMasGrandeOIgualQueElResto(r: reunion, s: señal){
    (∀i : Z) (
        (0 ≤ i < |r|) →L (
            tonoDeVoz(s) >= tonoDeVoz(fst(r[i]))
        )
    )
}

aux tonoDeVoz(s: señal) : Z = 
    sumaDelValorAbsolutoDeAmplitudes(s) div |s|

aux sumaDelValorAbsolutoDeAmplitudes(s:señal): Z =
   |s|
    Σ abs(s[i])
   i=0
~~~