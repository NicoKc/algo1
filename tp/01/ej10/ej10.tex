
\begin{proc}{reconstruir}{\In s: $señal$,
    \In prof: \ent,
    \In freq: \ent,
    \Out señal: \bool}{}
\pre{ esSeñalAux(s, prof, freq) }
\post{

    \quad esSeñalAux(result) \wedge

        \quad\quad (\longitud{s} = \longitud{result} \yLuego

        \quad\quad $enDondeNoSeaCeroDebenCoincidir$(s, result) \yLuego

        \quad\quad $enDondeEsCeroDebeSerElPromedioDeSusVecinosNoNulos$(s, result))

}
\end{proc}

\pred{enDondeEsCeroDebeSerElPromedioDeSusVecinosNoNulos}{original: señal,
    reconstruida: señal}
{

    \quad\paraTodo{i}{0}{\longitud{original}}
    \implicaLuego
        
        \quad\quad$(original[i] = 0)$ \yLuego 
        $reconstruida[i] = promedioDeVecinosNoNulos(original[i], reconstruida[i])$

}

$ $

\aux{promedioDeVecinosNoNulos}{s: $señal$,
    i: \ent}{\ent}
{   
    \frac{(s[elIndiceNoNuloMasCercano(s, i)] + s[el2doIndiceNoNuloMasCercano(s, i)])}{2}
}

$ $

\aux{elIndiceNoNuloMasCercano}{s: $señal$,
    i: \ent}{\ent}
{

    \quad\IfThenElse{
        dist(i, indiceSiguienteNoNulo(s, i)) < dist(i, indiceAnteriorNoNulo(s, i))
    }{

        \quad\quad$indiceSiguienteNoNulo(s, i)$

    \quad}{

        \quad\quad\IfThenElse{
            dist(i, indiceSiguienteNoNulo(s, i))> dist(i, indiceAnteriorNoNulo(s,i))
        }{

            \quad\quad\quad$indiceAnteriorNoNulo(s, i)$

        \quad\quad}{

            \quad\quad\quad$indiceAnteriorNoNulo(s, i)$ \vee $indiceSiguienteNoNulo(s, i)$
        
        \quad\quad}

    \quad}
}

$ $

\aux{dist}{x: \ent,
    y: \ent}{\ent}{
    abs(x-y)
}

$ $

\aux{indiceAnteriorNoNulo}{s: $señal$,
    i: \ent}{\ent}{
    \sum_{p=0}^{i-1}
    \IfThenElse{esElPrimerAnteriorNoNulo(s, i, p)}{p}{0}
}

$ $

\pred{esElPrimerAnteriorNoNulo}{s: $señal$,
    i: \ent,
    p: \ent}
{
    \paraTodo{j}{p}{i}
    \implicaLuego
    (s[j] = 0) \yLuego (s[p] \neq 0)
}

$ $

\aux{indiceSiguienteNoNulo}{s: $señal$,
    i: \ent}{\ent}
{
    \sum_{p=i+1}^{\longitud{s}-1}
    \IfThenElse{esElPrimerSiguienteNoNulo(s, i, p)}{p}{0}
}

$ $

\pred{esElPrimerSiguienteNoNulo}{s: $señal$,
    i: \ent,
    p: \ent}
{
    \paraTodo{j}{i}{p}
    \implicaLuego
    (s[j] = 0) \yLuego (s[p] \neq 0)
}

$ $

\aux{el2doIndiceNoNuloMasCercano}{s: $señal$,
    i: \ent}{\ent}{

    \quad$elIndiceNoNuloMasCercano(setAt(s, elIndiceNoNuloMasCercano(s, i), 0))$}

$ $

\pred{enDondeNoSeaCeroDebenCoincidir}{original: señal,
    reconstruida: señal}
{

    \quad\paraTodo{i}{0}{\longitud{original}}
    \implicaLuego
    ($original[i]$ \neq 0) \yLuego $(original[i] = reconstruida[i])$

}
