\documentclass{article}
\usepackage{xcolor}
\input{../../../../recursos/latex/Algo1Macros.tex}

\begin{document}

\section*{Demostración de correctitud del programa 1}

\subsection*{Demostración de correctitud}

\begin{itemize}
    \item $Pre \implica wp($codigo previo al cilco$,P_{c})$
    \item $P_{c} \implica wp(ciclo, Q_{c})$
    \item $Q_{c} \implica wp($codigo post ciclo$,Post)$
\end{itemize}

Por monotonia sabemos que $Pre \implica wp($programa completo$, Post)$

\subsection*{Datos}

\begin{itemize}
    \item $Pre      \equiv \longitud{s} > 0$
    \item $Post     \equiv 0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j])$
    \item $P_{c}    \equiv \longitud{s} > 0 \wedge i = 0 \wedge r = 0$
    \item $Q_{c}    \equiv 0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j])$
    \item $I        \equiv (0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j])$
    \item $B        \equiv i < \longitud{s}$
    \item $f_{v}    \equiv \longitud{s} - i$
    \item $S1       \equiv \IfThenElse{s[i] \geq s[r]}{r:= i}{skip}$
    \item $S2       \equiv i:= i + 1$
    \item $ciclo    \equiv S1; S2$
\end{itemize}

\subsection*{$Pre \implica wp($codigo previo al cilco$,P_{c})$}

    $wp(i:=0, wp(r:= 0, \longitud{s} > 0 \wedge i = 0 \wedge r = 0)) \equiv \longitud{s} > 0$

    $Pre \implica wp($codigo previo al cilco$,P_{c}) \equiv$

    $ \longitud{s} > 0 \implica \longitud{s} > 0 \equiv \True $

\subsection*{$Q_{c} \implica wp($codigo post ciclo$,Post)$}

    $Q_{c} \implica wp($codigo post ciclo$,Post) \equiv$

    $0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j]) \implica$

    $0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j]) \equiv \True$

\subsection*{$P_{c} \implica wp(ciclo, Q_{c})$}
\subsubsection*{Teorema del invariante}
\begin{itemize}
    \item $ P_{c} \implica I $
    \item $ (I \wedge \neg B) \implica Q_{c} $
    \item $ \{I \wedge B\} ciclo \{I\} $
    \item $ \{I \wedge B \wedge f_{v}=v_{0}\} ciclo \{f_{v}<v_{0}\} $
    \item $ (I \wedge f_{v} \leq 0) \implica \neg B$
\end{itemize}
\subsubsection*{$ P_{c} \implica I $}

\begin{itemize}
    \item $P_{c}    \equiv \longitud{s} > 0 \wedge i = 0 \wedge r = 0$
    \item $I        \equiv (0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j])$
\end{itemize}

$\longitud{s} > 0 \wedge i = 0 \wedge r = 0 \implica$

$(0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j]) \equiv \True$

\subsubsection*{$ (I \wedge \neg B) \implica Q_{c} $}

\begin{itemize}
    \item $Q_{c}    \equiv 0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j])$
    \item $I        \equiv (0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j])$
    \item $B        \equiv i < \longitud{s}$
    \item $\neg B   \equiv i \geq \longitud{s}$
\end{itemize}

$(0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j]) \wedge i \geq \longitud{s} \equiv$ \\

$i = \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j]) \implica$

$0 \leq r < \longitud{s} \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{\longitud{s}}\implicaLuego s[r] > s[j]) \equiv \True$

\subsubsection*{$ \{I \wedge B\} ciclo \{I\} $}
\begin{itemize}
    \item $I        \equiv (0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j])$
    \item $B        \equiv i < \longitud{s}$
    \item $S1       \equiv \IfThenElse{s[i] \geq s[r]}{r:= i}{skip}$
    \item $S2       \equiv i:= i + 1$
    \item $ciclo    \equiv S1; S2$
\end{itemize}

\begin{itemize}
    \item $wp(ciclo, I) \equiv wp(S1;S2, I) \stackrel{Ax3}{\equiv} wp(S1,wp(S2, I))$
    \item $wp(S2,I) \equiv$
    
    $wp(i:= i + 1, (0 \leq i \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j])) \equiv$

    $(0 \leq i + 1 \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i + 1}\implicaLuego s[r] > s[j]) \equiv$

    \item $wp(S1,wp(S2, I)) \equiv$

    $wp(\IfThenElse{s[i] \geq s[r]}{r:= i}{skip}, (0 \leq i + 1 \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i + 1}\implicaLuego s[r] > s[j])) \stackrel{Ax4}{\equiv}$

    $ \{ (0 \leq i < \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego ( $

    $ ( s[i] \geq s[r] ) \wedge 0 \leq i + 1 \leq \longitud{s} \yLuego (\paraTodo{j}{0}{i} \implicaLuego s[i] \geq s[j]) \wedge (\paraTodo{j}{i}{i + 1}\implicaLuego s[i] > s[j]) ) \vee $

    $ ( s[i] < s[r] \wedge (0 \leq i + 1 \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i + 1}\implicaLuego s[r] > s[j])) )\} $

\end{itemize}

$I \wedge B \equiv (0 \leq i < \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i}\implicaLuego s[r] > s[j]) \implica $ 

$ (0 \leq i < \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego ( $

$ ( s[i] \geq s[r] ) \wedge 0 \leq i + 1 \leq \longitud{s} \yLuego (\paraTodo{j}{0}{i} \implicaLuego s[i] \geq s[j]) \wedge (\paraTodo{j}{i}{i + 1}\implicaLuego s[i] > s[j]) ) \vee $

$ ( s[i] < s[r] \wedge (0 \leq i + 1 \leq \longitud{s} \wedge 0 \leq r < \longitud{s}) \yLuego (\paraTodo{j}{0}{r} \implicaLuego s[r] \geq s[j]) \wedge (\paraTodo{j}{r}{i + 1}\implicaLuego s[r] > s[j])) ) \equiv \True$

\subsubsection*{$ \{I \wedge B \wedge f_{v}=v_{0}\} ciclo \{f_{v}<v_{0}\} $}

    $\longitud{s} - i =v_{0} \implica \longitud{s} - i - 1 < v_{0} \equiv \True $

\subsubsection*{$ (I \wedge f_{v} \leq 0) \implica \neg B$}

    $\longitud{s} - i \leq 0 \implica i \geq \longitud{s} $

\end{document}